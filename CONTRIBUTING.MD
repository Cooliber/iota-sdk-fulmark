## ‚öôÔ∏è Prerequisites

Before starting, ensure the following tools are installed on your system:

- [Go](https://golang.org/doc/install)
- [Air](https://github.com/cosmtrek/air#Installation) for hot-reloading
- [Docker](https://docs.docker.com/get-docker/) for containerized services
- [SQL-Migrate](https://github.com/rubenv/sql-migrate) for database migrations
- [Templ](https://templ.guide/) for templating
- [TailwindCSS](https://tailwindcss.com/docs/installation) for styling
- [golangci-lint](https://golangci-lint.run/welcome/install/) for linting

---

## üõ†Ô∏è Development Setup

1. **Clone the repository**:
   ```bash
   git clone https://github.com/iota-agency/iota-sdk.git
   ```

2. **Install dependencies**:
   ```bash
   go get -u -d ./...
   ```

3. **Set up TailwindCSS globally**:
   ```bash
   pnpm install -g tailwindcss
   # or
   npm install -g tailwindcss
   ```

4. **Run PostgreSQL**:
   ```bash
   docker compose -f docker-compose.dev.yml up -d
   ```

5. **Apply database migrations**:
   ```bash
   sql-migrate up
   ```

6. **Start hot-reloading with Air**:
   ```bash
   air
   ```

7. **Enable Templ in watch mode**:
   ```bash
   templ generate -watch
   ```

8. **Compile TailwindCSS**:
   ```bash
   tailwindcss -c tailwind.config.js -i internal/presentation/assets/css/main.css -o internal/presentation/assets/css/main.min.css --minify --watch
   ```

9. **Access the GraphQL Schema**:  
   Open Postman and connect to:  
   [http://localhost:3200/query](http://localhost:3200/query)

---

## üîç Example Queries

### Fetch Employees and Positions

Use the following GraphQL query to retrieve users and their roles:

```graphql
query Users {
    users(limit: 10, offset: 0) {
        total
        data {
            id
            email
            firstName
            lastName
            avatar {
                id
                size
            }
        }
    }
}
```

---

## Code

If the size of the array is known, use `make` to create the array with the correct size

```go
package main

// Bad
var employees []string
for i := 0; i < 10; i++ {
employees = append(employees, "employee")
}

// Good
employees := make([]string, 10)

for i := 0; i < 10; i++ {
employees[i] = "employee"
}
```

## Project structure

We follow the [Standard Go Project Layout](https://github.com/golang-standards/project-layout) and DDD principles.
Below is an example of a project structure

```
project-root/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ       ‚îî‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ application.go
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.go
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_repository.go
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_service.go
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ persistence/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_repository.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ event/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ event_publisher.go
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ graph/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ users.graphqls
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ users.resolvers.go
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ gqlmodels/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ models_gen.go
‚îÇ   ‚îî‚îÄ‚îÄ presentation/
‚îÇ       ‚îú‚îÄ‚îÄ templates/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home/
‚îÇ       ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/
‚îÇ       ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ list.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ       ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard.templ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ layouts/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.templ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ navbar.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ footer.templ
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sidebar.templ
‚îÇ       ‚îú‚îÄ‚îÄ controllers/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ user_controller.go
‚îÇ       ‚îî‚îÄ‚îÄ static/
‚îÇ           ‚îú‚îÄ‚îÄ css/
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
‚îÇ           ‚îî‚îÄ‚îÄ js/
‚îÇ               ‚îî‚îÄ‚îÄ scripts.js
‚îî‚îÄ‚îÄ go.mod
```

## Types

Use `int64` for `count` && `ID` fields

```go
package models

type Employee struct {
	ID         int64
	Email      string
	FirstName  string
	LastName   string
	PositionID int64
	Salary     float64
}
```

## Naming

### GraphQL

For queries and mutations, we use camelCase. Below is an example for the `users` service

```graphql
type User {
    id: ID!
    firstName: String!
    lastName: String!
    email: String!
    createdAt: Time!
    updatedAt: Time!
}

type PaginatedUsers {
    data: [User!]!
    total: Int64!
}

input CreateUser {
    firstName: String!
    lastName: String!
    email: String!
}

input UpdateUser {
    firstName: String
    lastName: String
    email: String
}

extend type Query {
    user(id: ID!): User
    users(offset: Int!, limit: Int!, sortBy: [String!]): PaginatedUsers!
}

extend type Mutation {
    createUser(input: CreateUser!): User!
    updateUser(id: ID!, input: UpdateUser!): User!
    deleteUser(id: ID!): User!
}

extend type Subscription {
    userCreated: User!
    userUpdated: User!
    userDeleted: User!
}
```

### Code style

We use the [standard Go code style](https://go.dev/doc/effective_go) with the following exceptions:

- We use `PascalCase` for struct fields
- We use `PascalCase` for file names
